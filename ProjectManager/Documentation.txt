Bugs:

#1
#2
#3
#4

Bottleneck:

#1
In CmdsFactory.BuildCommand() there is a pointless while and for loops.